---
layout: default
section: books
---
{% assign books_grouped = site.books | group_by: 'category' | sort: 'name' | reverse %}

<div class="has-layout">
  {% include global/page-header.html %}

{% for book_group in books_grouped %}

  {% assign books = book_group.items | sort: 'date' | reverse %}


  {% for page in books  %}
  <section class="side-content book-meta">
    {% include books/cover.html %}
    <div class="book-meta-data">
    {% include books/meta.html %}
    {% assign now = site.time | date: '%Y%m%d' %}
      {% assign pubdate = page.date | date: '%Y%m%d' %}
      {% if now <= pubdate %}
        {% include modal.html text="Preorder"  %}
      {% else %}
        {% include modal.html text="Buy" %}
      {% endif %}
      </div>

  </section>
  <section class="primary-content">
    {% include books/title.html %}
    {{ page.content }}
  </section>
  <hr style="width: 100%;margin:8em auto;" />
{% endfor %}
{% endfor %}
</div>
